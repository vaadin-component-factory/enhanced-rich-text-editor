# Phase 4.1: Tables Project Setup & Base

**Status:** COMPLETE

## Objective

Set up the V25 Tables addon module structure, dependencies, Java stub classes, JS connector, and demo integration.

## What Was Done

### POM Updates
- `enhanced-rich-text-editor-tables/pom.xml`: Changed groupId from `org.vaadin.addons.componentfactory` to `com.vaadin.componentfactory`, added JUnit 5 + Mockito 5 test dependencies
- `enhanced-rich-text-editor-demo/pom.xml`: Added `enhanced-rich-text-editor-tables` dependency

### Java Stub Classes (26 files)

Package: `com.vaadin.componentfactory.erte.tables`

**Main package (3 files):**
- `EnhancedRichTextEditorTables` — Main extension class with `enable(rte)` / `enable(rte, i18n)` factory, `@JsModule` annotation
- `EnhancedRichTextEditorTablesComponentEvent` — Base event class
- `TablesI18n` — Complete i18n class (copied from V24)

**Events (2 files):**
- `TableSelectedEvent` — Table selection/deselection (fixed V24 StringUtils → String.isBlank)
- `TableCellChangedEvent` — Cell index changes

**Template Events (7 files):**
- `TemplateModificationEvent` (abstract) — Uses Jackson 3 ObjectNode
- `TemplateCreatedEvent`, `TemplateCopiedEvent`, `TemplateUpdatedEvent`, `TemplateDeletedEvent`
- `TemplateSelectedEvent`
- `TemplatesInitializedEvent` — **Fixed V24 typo** "Initialiazed" → "Initialized"

**Template Utilities (5 files):**
- `TemplateJsonConstants` — Pure constants (copied from V24)
- `Dimension` — Value+unit class (copied from V24)
- `TemplateParser` — Stub with `convertToCss()`, `clone()`, `isValidTemplateId()`
- `TemplateDialog` — Stub extending ToolbarDialog, inner classes `TemplateModificationDetails`, `Defaults`, `DefaultValueChangeEvent`
- `DimensionField` — CustomField stub

**Rule Form Parts (9 files):**
- `RuleFormPart` (abstract, extends VerticalLayout)
- `DefaultPropertiesFormPart` (abstract)
- `TableFormPart`
- `AbstractIndexedFormPart` (abstract)
- `AbstractRowFormPart` (abstract), `FixedIndexRowFormPart`, `CurrentRowFormPart`
- `AbstractColFormPart` (abstract), `CurrentColFormPart`

### ToolbarSwitch Enhancement (V25 Core)
Added dual-icon constructors from V24:
- `ToolbarSwitch(VaadinIcon icon, VaadinIcon suffixIcon)`
- `ToolbarSwitch(Component icon, Component suffixIcon)`

Uses `SlotUtil.addSuffixIcon()` (already existed in V25 core).

### JS Connector Stub
- `src/main/resources/META-INF/frontend/src/erte-table/connector.js` — IIFE with `extendQuill`/`extendEditor` hook registration and connector namespace stubs
- `src/main/resources/META-INF/frontend/src/erte-table/css/erte-table-styles.css` — Empty placeholder

### Demo Integration
- `ErteTablesTestView.java` — Route `erte-test/tables`, calls `enable(editor)`
- `ErteTestLayout.java` — Added "Phase 4 — Tables" section with "4.1 Tables Setup" nav item

## V24 → V25 Changes Applied
- Jackson 3 (`tools.jackson.databind.node.ObjectNode`) instead of `elemental.json.JsonObject`
- `jakarta.annotation.Nullable` instead of `javax.annotation.Nullable`
- Removed `org.apache.commons.lang3` (inline `String.isBlank()` / `.strip()`)
- No `@NpmPackage("quill-delta")` (Quill 2 vendors Delta)
- No `@CssImport` (deprecated in V25 — styles via connector)
- Fixed V24 typo: `TemplatesInitializedEvent`

## Verification
- BUILD SUCCESS — all 3 modules compile (V25 core, tables V25, demo)
- Server starts, `/erte-test/tables` loads editor correctly
- Browser console shows `[ERTE Tables] Connector loaded (Phase 4.1 stub)`
- Side navigation shows Phase 4 section

## Forward-Looking Notes (for Phase 4.2+)
1. `extendQuill` has no `options` parameter — need alternative for table module registration
2. V24 connector uses `__blot` — must use `Quill.find(domNode)` in V25
3. Shadow DOM style injection via connector (not `@CssImport`)
4. ToolbarSwitch dual-icon constructor now available (resolved in this phase)
