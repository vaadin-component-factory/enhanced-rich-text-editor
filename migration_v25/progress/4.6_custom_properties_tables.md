# Phase 4.6: Custom Properties for Tables Addon Styles

**Status:** NOT STARTED
**Type:** Theming API Enhancement
**Priority:** MEDIUM — Improves user customization
**Depends on:** Phase 4.1-4.5 (Tables Addon implementation)

## Objective

Create dedicated CSS custom properties (with `--vaadin-erte-table-*` prefix) for all Tables addon-specific styles that currently use generic `--vaadin-*` properties or hardcoded values. This follows Vaadin component conventions and allows users to style Tables addon independently from ERTE core and other Vaadin components.

## Background

The Tables addon (V24) uses a mix of:
- Generic Vaadin properties (`--vaadin-*`)
- Hardcoded CSS values (colors, borders, spacing)
- Template-based styles (cell formatting, row styles)

Unlike ERTE core (which uses static CSS classes), Tables addon supports **template-based styling** where users define table layouts with custom CSS classes per template. This requires a different approach:
- **Static properties** for table infrastructure (borders, cell padding, selection highlights)
- **Template-scoped properties** for user-defined styles (cell colors, fonts, alignments per template)

## Current Situation (V24 Reference)

Tables addon V24 uses various styling approaches:

**Infrastructure styles:**
```css
.ql-table {
  border-collapse: collapse;
  border: 1px solid #ccc;
}

.ql-table-cell {
  border: 1px solid #ddd;
  padding: 8px;
  min-width: 50px;
}
```

**Template-based styles:**
Users create table templates with custom cell formats:
```java
TableTemplate template = new TableTemplate("invoice");
template.setHeaderStyle("background: #4CAF50; color: white;");
template.setCellStyle("padding: 12px; border-bottom: 1px solid #eee;");
```

**Problem:**
- Hardcoded values (`#ccc`, `8px`, etc.) cannot be themed
- No way to style Tables independently from ERTE core
- Template styles are raw CSS strings, not integrated with Vaadin's theming system

## Requirements

### 1. Create Custom Properties for Infrastructure

For table-level infrastructure (not template-specific), create custom properties with prefix `--vaadin-erte-table-*`:

**Naming convention:**
- Format: `--vaadin-erte-table-{element}-{property}`
- Examples:
  - `--vaadin-erte-table-border-color`
  - `--vaadin-erte-table-cell-padding`
  - `--vaadin-erte-table-cell-border-color`
  - `--vaadin-erte-table-selected-background`
  - `--vaadin-erte-table-hover-background`

**Default values:**
- Custom properties should default to sensible values compatible with Lumo theme
- Example: `--vaadin-erte-table-border-color: var(--vaadin-border-color);`

### 2. Template-Based Styling Strategy

**Challenge:** Table templates allow users to define arbitrary CSS via Java API. We cannot intercept or replace these styles with custom properties at definition time.

**Proposed approach:**

1. **Provide custom property defaults** in table blot styles:
   ```css
   .ql-table-cell {
     padding: var(--vaadin-erte-table-cell-padding, 8px);
     border: 1px solid var(--vaadin-erte-table-cell-border-color, #ddd);
   }
   ```

2. **Document custom properties** in user guide with examples showing how to reference them in template definitions:
   ```java
   template.setCellStyle(
     "padding: var(--vaadin-erte-table-cell-padding); " +
     "border-bottom: 1px solid var(--vaadin-erte-table-cell-border-color);"
   );
   ```

3. **Keep template flexibility** — users can still use hardcoded values if they want, but custom properties are available for theme-consistent styling.

### 3. Update All Tables Addon Styles

Replace hardcoded values with `--vaadin-erte-table-*` in:
- Table container styles (`.ql-table`)
- Cell styles (`.ql-table-cell`, `.ql-table-header-cell`)
- Row styles (`.ql-table-row`)
- Selection highlights (`.ql-table-selected`)
- Resize handles (if applicable)
- Any other table-specific styles

### 4. Define Properties in Component

Custom properties should be defined in the table blot's CSS (likely in the V25 table blot implementation files, similar to how ERTE core defines properties in `vcf-enhanced-rich-text-editor.js` static styles).

### 5. Complete Documentation

After implementation, this progress file **MUST** contain:
- **COMPLETE list of ALL table custom properties**
- **Short description for each property**
- **Default value for each property**
- **Example usage in templates** (how users can reference properties in template definitions)
- **Example usage in global styles** (how users can override properties globally)

## Scope

### In Scope
- All table infrastructure styles (borders, padding, spacing, selection)
- Cell and row base styles
- Table container styles
- Selection and hover states
- Resize handles (if applicable)

### Out of Scope
- Template-specific content styles (users define these via template API)
- RTE 2 base styles (inherited from ERTE core)
- ERTE core styles (already covered in Phase 3.4k)

## Implementation Steps

1. **Audit existing V24 table styles** — Find all hardcoded values in table-related blots
2. **Define custom properties** — Create `--vaadin-erte-table-*` properties with defaults
3. **Update table blot styles** — Replace hardcoded values with custom properties
4. **Test visual consistency** — Ensure default appearance matches V24
5. **Document all properties** — Update this file with complete property list
6. **Update user documentation** — Add Tables theming guide showing:
   - How to override table properties globally
   - How to use custom properties in table templates
   - Example table templates using custom properties

## Success Criteria

- [ ] All table infrastructure styles use `--vaadin-erte-table-*` custom properties
- [ ] Default visual appearance matches V24 (properties default to current values)
- [ ] Users can override table styles independently from ERTE core and other Vaadin components
- [ ] This progress file contains complete, documented list of all table custom properties
- [ ] User documentation includes Tables theming guide with examples
- [ ] Template API documentation shows how to use custom properties in templates

## Custom Properties List

*To be filled after implementation.*

This section will contain the complete list of all `--vaadin-erte-table-*` custom properties with:
- Property name
- Description
- Default value
- Affected elements/features
- Example usage (global override + template reference)

**Format:**
```
### --vaadin-erte-table-{name}
**Description:** {what it controls}
**Default:** `{default value}`
**Affects:** {which table elements}
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-{name}: {custom value};
}
```
**Example (template reference):**
```java
template.setCellStyle("property: var(--vaadin-erte-table-{name});");
```
```

## Notes

- **Theme scope:** ERTE 6.0.0 supports Lumo theme only. Table custom properties will be designed for Lumo-based theming.
- **Future multi-theme support (Phase 5.1):**
  - When Aura theme support is added in Phase 5.1, all table custom properties defined here will be audited for Aura compatibility
  - Properties may need theme-specific overrides via `:host([theme~="aura"])` selectors
  - Default values should use generic Vaadin tokens (`--vaadin-*`) where possible for cross-theme compatibility
  - Phase 5.1 will review and update this property list with Aura-specific notes
- **Template flexibility:** Users can still use hardcoded CSS values in templates, but custom properties provide theme consistency.
- **V24 reference:** Review V24 table blot implementations for existing style patterns and hardcoded values.
- **Sanitizer consideration:** Table templates use template-based sanitization (pattern matching), not static class whitelisting like ERTE core. Custom properties don't affect sanitizer logic.

## Related Files

- `enhanced-rich-text-editor-tables-v25/src/main/resources/META-INF/resources/frontend/` (table blot implementations)
- V24 reference: `enhanced-rich-text-editor-tables/src/main/resources/META-INF/resources/frontend/` (legacy table blots)
- User documentation (to be updated with Tables theming guide)

## Dependencies

- **Prerequisite:** Phase 4.1-4.5 must be complete (Tables addon fully implemented and tested)
- **Can be done in parallel with:** Phase 3.4k (ERTE core custom properties) — both are independent
- **Should be done before:** Phase 4.5 (Documentation) — theming guide needs custom properties list
