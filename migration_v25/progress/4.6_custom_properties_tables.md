# Phase 4.6: Custom Properties for Tables Addon Styles

**Status:** COMPLETE
**Type:** Theming API Enhancement
**Priority:** MEDIUM — Improves user customization
**Depends on:** Phase 4.1-4.4 (Tables Addon implementation)

## Objective

Create dedicated CSS custom properties (with `--vaadin-erte-table-*` prefix) for all Tables addon-specific visual values. Follows the same pattern as ERTE core (Phase 3.4k): defaults in `:host`, no fallbacks in rules, cross-theme tokens where available.

## Implementation Summary

**File changed:** `enhanced-rich-text-editor-tables/src/main/resources/META-INF/frontend/src/erte-table/css/erte-table-styles.css`

**Changes:**
- 7 new custom properties added (total: 11)
- `--vaadin-erte-table-cell-hover-color` renamed to `--vaadin-erte-table-cell-hover-background` (consistency)
- `--vaadin-erte-table-border-color` default changed to use `--vaadin-border-color` cross-theme token
- `--vaadin-erte-table-cell-focus-color` default changed to use `--vaadin-focus-ring-color` cross-theme token
- `--vaadin-erte-table-cell-focus-width` added, using `--vaadin-focus-ring-width` cross-theme token
- Focus ring `outline-offset` changed to `calc(-1 * width)` for dynamic sizing
- Forced-colors media query added for Windows High Contrast Mode (WCAG)
- Selection highlight uses gradient pattern to layer over template backgrounds
- All fallback values moved to `:host` block only (matches core ERTE pattern)

## Custom Properties List (11 total)

### Cell Appearance (7 properties)

---

### --vaadin-erte-table-border-color
**Description:** Color of table cell borders
**Default:** `var(--vaadin-border-color, var(--lumo-contrast-30pct))`
**Cross-theme token:** `--vaadin-border-color`
**Affects:** All `td.td-q` cell borders
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-border-color: #e0e0e0;
}
```
**Example (template reference):**
```java
template.setCellStyle("border-color: var(--vaadin-erte-table-border-color);");
```

---

### --vaadin-erte-table-border-width
**Description:** Thickness of table cell borders
**Default:** `1px`
**Affects:** All `td.td-q` cell borders, focus ring offset calculation
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-border-width: 2px;
}
```

---

### --vaadin-erte-table-border-style
**Description:** Line style of table cell borders (solid, dashed, dotted, etc.)
**Default:** `solid`
**Affects:** All `td.td-q` cell borders
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-border-style: dashed;
}
```

---

### --vaadin-erte-table-cell-padding
**Description:** Content padding inside table cells
**Default:** `2px 5px`
**Affects:** All `td.td-q` cells
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-padding: 8px 12px;
}
```
**Example (template reference):**
```java
template.setCellStyle("padding: var(--vaadin-erte-table-cell-padding);");
```

---

### --vaadin-erte-table-cell-min-height
**Description:** Minimum height for table cells/rows
**Default:** `1.625em`
**Affects:** All `td.td-q` cells
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-min-height: 2em;
}
```

---

### --vaadin-erte-table-cell-background
**Description:** Default background color for table cells
**Default:** `transparent`
**Affects:** All `td.td-q` cells (template styles override per-cell)
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-background: var(--lumo-base-color);
}
```

---

### --vaadin-erte-table-cell-vertical-align
**Description:** Vertical content alignment within cells (top, middle, bottom)
**Default:** `top`
**Affects:** All `td.td-q` cells. Useful for tables as form layouts or data grids where middle alignment is preferred.
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-vertical-align: middle;
}
```

---

### Cell States (4 properties)

---

### --vaadin-erte-table-cell-selected-background
**Description:** Background overlay for multi-cell selection. Uses `background-image: linear-gradient()` to layer over existing cell/template backgrounds instead of replacing them.
**Default:** `var(--lumo-primary-color-10pct, rgba(25, 118, 210, 0.1))`
**Affects:** `td.ql-cell-selected` — cells selected via Ctrl+drag
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-selected-background: rgba(0, 128, 0, 0.15);
}
```

---

### --vaadin-erte-table-cell-hover-background
**Description:** Background color on cell hover
**Default:** `transparent`
**Affects:** `td:hover` — all table cells on mouse hover
**Note:** Renamed from `--vaadin-erte-table-cell-hover-color` for consistency (safe: 6.0.0 unreleased)
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-hover-background: var(--lumo-contrast-5pct);
}
```

---

### --vaadin-erte-table-cell-focus-color
**Description:** Color of the focus outline on the keyboard-focused cell. Matches vaadin-grid cell focus pattern.
**Default:** `var(--vaadin-focus-ring-color, var(--lumo-primary-color-50pct))`
**Cross-theme token:** `--vaadin-focus-ring-color`
**Affects:** `td.focused-cell` — cell with keyboard focus
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-focus-color: var(--lumo-error-color);
}
```

---

### --vaadin-erte-table-cell-focus-width
**Description:** Thickness of the focus outline on the keyboard-focused cell
**Default:** `var(--vaadin-focus-ring-width, 2px)`
**Cross-theme token:** `--vaadin-focus-ring-width`
**Affects:** `td.focused-cell` — cell with keyboard focus (also adjusts `outline-offset` dynamically)
**Example (global override):**
```css
vcf-enhanced-rich-text-editor {
  --vaadin-erte-table-cell-focus-width: 3px;
}
```

---

## Cross-Reference with ERTE Core Properties

| Aspect | Core ERTE (Phase 3.4k) | Tables (Phase 4.6) | Consistent? |
|--------|------------------------|---------------------|-------------|
| Namespace | `--vaadin-erte-{feature}-` | `--vaadin-erte-table-` / `table-cell-` | Yes |
| Border color token | `--vaadin-border-color` (ruler) | `--vaadin-border-color` (cells) | Yes |
| Focus ring | `--vaadin-focus-ring-width/color` (toolbar) | `--vaadin-focus-ring-width/color` (cell focus) | Yes |
| Fallback pattern | `:host` only | `:host` only | Yes |
| Border-radius | Has it (readonly, placeholder) | None (border-collapse prevents) | Correct |

## Accessibility

- **Forced-colors media query** (`@media (forced-colors: active)`) ensures table selection and focus states are visible in Windows High Contrast Mode
- Selected cells: `outline: 2px solid Mark` (replaces gradient overlay)
- Focused cell: `outline: 3px solid Highlight` (thicker to distinguish from selection)

## Explicit Exclusions (NOT custom properties)

- `width: 100%` / `border-collapse` / `table-layout` / `overflow` — table layout mechanics
- `white-space: pre-wrap` — text behavior
- `cursor: cell` — Ctrl-select feature toggle, not theming
- `text-align` — controlled by Quill align format
- `border: none !important` (hideBorder) — functional toggle
- `display: none` (merged cells) — structural

## Success Criteria

- [x] All table infrastructure styles use `--vaadin-erte-table-*` custom properties
- [x] Default visual appearance matches previous (properties default to current values)
- [x] Users can override table styles independently from ERTE core
- [x] This progress file contains complete, documented list of all table custom properties
- [x] Forced-colors media query for Windows High Contrast Mode
- [x] Cross-theme tokens used where available (`--vaadin-border-color`, `--vaadin-focus-ring-*`)
- [ ] User documentation includes Tables theming guide with examples (deferred to Phase 4.5)

## Related Files

- `enhanced-rich-text-editor-tables/src/main/resources/META-INF/frontend/src/erte-table/css/erte-table-styles.css`
- ERTE core properties: `enhanced-rich-text-editor/src/main/resources/META-INF/frontend/src/vcf-enhanced-rich-text-editor.js`
