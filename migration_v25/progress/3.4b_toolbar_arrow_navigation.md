# Phase 3.4b: Toolbar Arrow-Key Navigation (Left/Right)

## Status: NOT STARTED

## Description

Fix Left/Right arrow key navigation in the toolbar. Currently, when a toolbar button has focus, Left/Right arrow keys do nothing (likely console error). This navigation works in stock RTE 2 but is broken in ERTE.

## Problem

- **Working**: Tab → editor focus, Shift+Tab → previous button focus
- **Broken**: Left/Right arrow keys do nothing when toolbar button has focus
- **Expected**: Left/Right should cycle through toolbar buttons (matching stock RTE 2 behavior)

## Root Cause Hypothesis

The keyboard shortcut injection (Phase 3.2b) or slot injection (Phase 3.1a) likely interferes with RTE 2's `__patchToolbar()` keyboard handling. The parent's arrow key handlers may be blocked or overridden by ERTE's custom keyboard bindings.

## Requirements

- Left/Right arrow keys should cycle through all toolbar buttons
- Navigation should **include custom slotted elements** (e.g., custom buttons added via slots)
- Navigation should **skip elements that consume arrow events** (e.g., text inputs)
- Behavior should match stock RTE 2 exactly

## Implementation Approach

1. **Investigate**: Check if ERTE's keyboard bindings in the editor interfere with toolbar focus
2. **Debug**: Look for console errors when pressing Left/Right on focused toolbar button
3. **Locate**: Find RTE 2's `__patchToolbar()` arrow handling in reference code
4. **Fix**: Likely need to preserve or re-invoke parent's toolbar keyboard handling after slot injection
5. **Test**: Verify Left/Right cycles through buttons (stock + custom), Tab/Shift+Tab still works

## RTE 2 Reference

Check `/workspace/migration_v25/reference/web-components/packages/rich-text-editor/src/vaadin-rich-text-editor-mixin.js` for `__patchToolbar()` implementation.

## Acceptance Criteria

- [ ] Left arrow moves focus to previous toolbar button
- [ ] Right arrow moves focus to next toolbar button
- [ ] Arrow navigation cycles (wraps at start/end)
- [ ] Custom slotted buttons are included in navigation
- [ ] Elements that consume arrow events are skipped
- [ ] Tab and Shift+Tab navigation still works
- [ ] No console errors
- [ ] Behavior matches stock RTE 2

## Test Impact

Existing toolbar keyboard navigation tests should pass. May need to add explicit Left/Right arrow tests if not already covered in `toolbar.spec.ts`.
